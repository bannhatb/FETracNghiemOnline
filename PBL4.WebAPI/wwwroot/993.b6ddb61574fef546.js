"use strict";var Zt=Object.defineProperty,It=Object.defineProperties,Dt=Object.getOwnPropertyDescriptors,ge=Object.getOwnPropertySymbols,Ot=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable,pe=(k,T,g)=>T in k?Zt(k,T,{enumerable:!0,configurable:!0,writable:!0,value:g}):k[T]=g,b=(k,T)=>{for(var g in T||(T={}))Ot.call(T,g)&&pe(k,g,T[g]);if(ge)for(var g of ge(T))Mt.call(T,g)&&pe(k,g,T[g]);return k},$=(k,T)=>It(k,Dt(T));(self.webpackChunkUI=self.webpackChunkUI||[]).push([[993],{9993:(k,T,g)=>{g.r(T),g.d(T,{TestModule:()=>At});var P=g(6019),R=g(9010),_e=g(8338),S=g(3611),N=g(953),W=g(4085),n=g(865),D=g(1931),fe=g(5548),me=g(1346);class be extends me.w{constructor(e,t){super()}schedule(e,t=0){return this}}let G=(()=>{class r{constructor(t,o=r.now){this.SchedulerAction=t,this.now=o}schedule(t,o=0,s){return new this.SchedulerAction(this,t).schedule(s,o)}}return r.now=()=>Date.now(),r})();class E extends G{constructor(e,t=G.now){super(e,()=>E.delegate&&E.delegate!==this?E.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,o){return E.delegate&&E.delegate!==this?E.delegate.schedule(e,t,o):super.schedule(e,t,o)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let o;this.active=!0;do{if(o=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,o){for(;e=t.shift();)e.unsubscribe();throw o}}}const X=new E(class extends be{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const o=this.id,s=this.scheduler;return null!=o&&(this.id=this.recycleAsyncId(s,o,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,o=0){return setInterval(e.flush.bind(e,this),o)}recycleAsyncId(e,t,o=0){if(null!==o&&this.delay===o&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const o=this._execute(e,t);if(o)return o;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let s,o=!1;try{this.work(e)}catch(i){o=!0,s=!!i&&i||new Error(i)}if(o)return this.unsubscribe(),s}_unsubscribe(){const e=this.id,t=this.scheduler,o=t.actions,s=o.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==s&&o.splice(s,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}});var we=g(5894);function ye(r){const{subscriber:e,counter:t,period:o}=r;e.next(t),this.schedule({subscriber:e,counter:t+1,period:o},o)}function xe(r,e){if(1&r&&(n.TgZ(0,"span",5),n._uU(1),n.qZA()),2&r){const t=n.oxw();n.xp6(1),n.hij("",t.days,":")}}function Se(r,e){if(1&r&&(n.TgZ(0,"span",6),n._uU(1),n.qZA()),2&r){const t=n.oxw();n.xp6(1),n.hij("",t.hours,":")}}let ke=(()=>{class r{constructor(){this.seconds=0,this.minutes=0,this.hours=0,this.days=0}ngOnInit(){this.MiliSeconds=60*this.time*1e3,this.subscription=function(r=0,e=X){return(!function(r){return!(0,we.k)(r)&&r-parseFloat(r)+1>=0}(r)||r<0)&&(r=0),(!e||"function"!=typeof e.schedule)&&(e=X),new fe.y(t=>(t.add(e.schedule(ye,r,{subscriber:t,counter:0,period:r})),t))}(1e3).subscribe(t=>{this.allocateTimeUnits()})}allocateTimeUnits(){this.MiliSeconds=this.MiliSeconds-1e3,this.seconds=Math.floor(this.MiliSeconds/1e3%60),this.minutes=Math.floor(this.MiliSeconds/6e4%60),this.hours=Math.floor(this.MiliSeconds/36e5%24),this.days=Math.floor(this.MiliSeconds/864e5)}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=n.Xpm({type:r,selectors:[["app-count-down"]],inputs:{time:"time"},decls:9,vars:4,consts:[[1,"timer"],["id","days",4,"ngIf"],["id","hours",4,"ngIf"],["id","minutes"],["id","seconds"],["id","days"],["id","hours"]],template:function(t,o){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"h4"),n._uU(2," Th\u1eddi gian l\xe0m b\xe0i "),n.qZA(),n.YNc(3,xe,2,1,"span",1),n.YNc(4,Se,2,1,"span",2),n.TgZ(5,"span",3),n._uU(6),n.qZA(),n.TgZ(7,"span",4),n._uU(8),n.qZA(),n.qZA()),2&t&&(n.xp6(3),n.Q6J("ngIf",o.days>0),n.xp6(1),n.Q6J("ngIf",o.hours>0),n.xp6(2),n.hij("",o.minutes,":"),n.xp6(2),n.Oqu(o.seconds))},directives:[P.O5],styles:[".timer[_ngcontent-%COMP%]{text-align:center;font-family:Arial,sans-serif;font-size:1.4em;letter-spacing:-1px}.timer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:2em;margin:0 3px 0 15px}"]}),r})();var K=g(2113);function Ee(r,e){if(1&r){const t=n.EpF();n.TgZ(0,"div"),n.TgZ(1,"input",10),n.NdJ("change",function(s){return n.CHM(t),n.oxw(3).chooseOne(s)}),n.qZA(),n._UZ(2,"span",11),n.qZA()}if(2&r){const t=n.oxw().$implicit;n.xp6(1),n.s9C("value",t.id)}}function Pe(r,e){if(1&r){const t=n.EpF();n.TgZ(0,"div"),n.TgZ(1,"input",12),n.NdJ("change",function(s){return n.CHM(t),n.oxw(3).chooseOne(s)}),n.qZA(),n._UZ(2,"span",11),n.qZA()}if(2&r){const t=n.oxw().$implicit;n.xp6(1),n.s9C("value",t.id)}}function Ae(r,e){if(1&r&&(n.TgZ(0,"div",8),n.TgZ(1,"label",9),n._uU(2),n.YNc(3,Ee,3,1,"div",2),n.YNc(4,Pe,3,1,"div",2),n.qZA(),n.qZA()),2&r){const t=e.$implicit,o=n.oxw(2);n.xp6(2),n.hij("",t.answerContent," "),n.xp6(1),n.Q6J("ngIf",o.usChoosed(t.id)),n.xp6(1),n.Q6J("ngIf",!o.usChoosed(t.id))}}function Ze(r,e){if(1&r&&(n.TgZ(0,"div"),n.TgZ(1,"h2"),n._uU(2,"Ch\u1ecdn c\xe2u tr\u1ea3 l\u1eddi \u0111\xfang nh\u1ea5t"),n.qZA(),n.TgZ(3,"div",6),n.TgZ(4,"b"),n._uU(5),n.qZA(),n.qZA(),n.YNc(6,Ae,5,3,"div",7),n.qZA()),2&r){const t=n.oxw();n.xp6(5),n.AsE("C\xe2u: ",t.result.result.data.questions.numericalOrder," ",t.result.result.data.questions.questionContent,""),n.xp6(1),n.Q6J("ngForOf",t.result.result.data.questions.listAnswers)}}function Ie(r,e){if(1&r){const t=n.EpF();n.TgZ(0,"div"),n.TgZ(1,"input",13),n.NdJ("change",function(s){return n.CHM(t),n.oxw(3).chooseChange(s)}),n.qZA(),n._UZ(2,"span",14),n.qZA()}if(2&r){const t=n.oxw().$implicit;n.xp6(1),n.s9C("value",t.id)}}function De(r,e){if(1&r){const t=n.EpF();n.TgZ(0,"div"),n.TgZ(1,"input",15),n.NdJ("change",function(s){return n.CHM(t),n.oxw(3).chooseChange(s)}),n.qZA(),n._UZ(2,"span",14),n.qZA()}if(2&r){const t=n.oxw().$implicit;n.xp6(1),n.s9C("value",t.id)}}function Oe(r,e){if(1&r&&(n.TgZ(0,"div",8),n.TgZ(1,"label",9),n._uU(2),n.YNc(3,Ie,3,1,"div",2),n.YNc(4,De,3,1,"div",2),n.qZA(),n.qZA()),2&r){const t=e.$implicit,o=n.oxw(2);n.xp6(2),n.hij("",t.answerContent," "),n.xp6(1),n.Q6J("ngIf",o.usChoosed(t.id)),n.xp6(1),n.Q6J("ngIf",!o.usChoosed(t.id))}}function Me(r,e){if(1&r&&(n.TgZ(0,"div"),n.TgZ(1,"h2"),n._uU(2,"Ch\u1ecdn c\xe1c c\xe2u tr\u1ea3 l\u1eddi \u0111\xfang"),n.qZA(),n.TgZ(3,"div",6),n.TgZ(4,"b"),n._uU(5),n.qZA(),n.qZA(),n.YNc(6,Oe,5,3,"div",7),n.qZA()),2&r){const t=n.oxw();n.xp6(5),n.AsE("C\xe2u: ",t.result.result.data.questions.numericalOrder," ",t.result.result.data.questions.questionContent,""),n.xp6(1),n.Q6J("ngForOf",t.result.result.data.questions.listAnswers)}}function Ue(r,e){if(1&r){const t=n.EpF();n.TgZ(0,"div",16),n.TgZ(1,"app-paging",17),n.NdJ("changePage",function(s){return n.CHM(t),n.oxw().ChangePageHandler(s)}),n.qZA(),n.qZA()}if(2&r){const t=n.oxw();n.xp6(1),n.Q6J("totalPage",t.TotalPage)("currentPage",t.urlQuery.pageNumber)}}let qe=(()=>{class r{constructor(t,o,s){this.testService=t,this.activeRoute=o,this.router=s,this.choose=new Array,this.urlQuery=new W.e(1,1,""),this.page=1,this.isChoosed=new Array,this.total=0,this.TestTime=0}ngOnInit(){this.GetTime(),this.getQuestionTestUser()}GetTime(){this.activeRoute.params.subscribe(t=>{this.testId=t.testId}),this.testService.GetUserTestStatus(this.testId).subscribe(t=>{this.TestUserInfo=t,this.TestTime=this.TestUserInfo.result.data.time,console.log(this.TestTime)},t=>{console.log(t.error.message)},()=>{})}ChangePageHandler(t){this.urlQuery.pageNumber=t,this.getQuestionTestUser()}getQuestionTestUser(){this.choose.length>0&&(this.SubmitAnswer(),this.choose=new Array),this.activeRoute.params.subscribe(t=>{this.testId=t.testId}),this.testService.GetOneQuestionUserTest(this.testId,this.urlQuery.pageNumber).subscribe(t=>{var o;if(this.result=t,this.total=t,this.TotalPage=Math.ceil((null===(o=this.total.result)||void 0===o?void 0:o.data.total)/this.urlQuery.pageSize),this.result.result.data.questions.userChoose.length>0){this.isChoosed=new Array;for(let s in this.result.result.data.questions.userChoose)this.isChoosed.push(this.result.result.data.questions.userChoose[s].choose);this.choose=this.isChoosed}},t=>{console.log(t.error.message)},()=>{})}usChoosed(t){return this.isChoosed.some(function(o){return o===t})}SubmitTest(){this.testService.CacularPoint(this.testId).subscribe(t=>{}),this.router.navigateByUrl(`/test/user-point/${this.testId}`)}chooseOne(t){if(t.target.checked)this.choose.splice(0,1),this.choose.push(t.target.defaultValue);else{let o=this.choose.indexOf(t.target.defaultValue);this.choose.splice(o,1)}console.log(this.choose)}chooseChange(t){if(t.target.checked)this.choose.push(t.target.defaultValue);else{let o=this.choose.indexOf(t.target.defaultValue);this.choose.splice(o,1)}console.log(this.choose)}SubmitAnswer(){this.testService.UserChooseAnswer({testQuestionId:this.result.result.data.questions.id,answerIds:this.choose}).subscribe(o=>{},o=>console.log(o.error.message))}}return r.\u0275fac=function(t){return new(t||r)(n.Y36(D.q),n.Y36(S.gz),n.Y36(S.F0))},r.\u0275cmp=n.Xpm({type:r,selectors:[["app-user-test"]],decls:10,vars:4,consts:[[1,"container","mt-sm-5","my-1"],[1,"question","ml-sm-5","pl-sm-5","pt-2"],[4,"ngIf"],["class","center",4,"ngIf"],[1,"submitTest",3,"click"],[3,"time"],[1,"py-2","h5"],["class","ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3","id","options",4,"ngFor","ngForOf"],["id","options",1,"ml-md-3","ml-sm-3","pl-md-5","pt-sm-0","pt-3"],[1,"options"],["type","radio","checked","true","name","ans",3,"value","change"],[1,"checkmark"],["type","radio","name","ans",3,"value","change"],["type","checkbox","checked","true","name","ans",3,"value","change"],[1,"checkboxmark"],["type","checkbox","name","ans",3,"value","change"],[1,"center"],[3,"totalPage","currentPage","changePage"]],template:function(t,o){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.YNc(2,Ze,7,3,"div",2),n.YNc(3,Me,7,3,"div",2),n.qZA(),n.qZA(),n.YNc(4,Ue,2,2,"div",3),n.TgZ(5,"div"),n.TgZ(6,"button",4),n.NdJ("click",function(){return o.SubmitTest()}),n._uU(7,"Submit"),n.qZA(),n.qZA(),n.TgZ(8,"div"),n._UZ(9,"app-count-down",5),n.qZA()),2&t&&(n.xp6(2),n.Q6J("ngIf",1==o.result.result.data.questions.typeId),n.xp6(1),n.Q6J("ngIf",2==o.result.result.data.questions.typeId),n.xp6(1),n.Q6J("ngIf",o.TotalPage>1),n.xp6(5),n.Q6J("time",o.TestTime))},directives:[P.O5,ke,P.sg,K.L],styles:['@import"https://fonts.googleapis.com/css2?family=Montserrat&display=swap";*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}body[_ngcontent-%COMP%]{background-color:#333}.container[_ngcontent-%COMP%]{background-color:#555;color:#ddd;border-radius:10px;padding:20px;font-family:"Montserrat",sans-serif;max-width:700px}.container[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{font-size:32px}.question[_ngcontent-%COMP%]{width:75%}.options[_ngcontent-%COMP%]{position:relative;padding-left:40px}#options[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:15px;font-size:14px;cursor:pointer}.options[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0}.checkmark[_ngcontent-%COMP%]{position:absolute;top:-1px;left:0;height:25px;width:25px;background-color:#555;border:1px solid #ddd;border-radius:50%}.submitTest[_ngcontent-%COMP%]{width:150px;margin:20px auto;display:block;height:59px;text-align:center;font-size:26px;font-weight:normal;color:#fff;background-color:#8be91f;border-color:transparent;font-family:"Raleway",sans-serif;border-radius:4px}.submitTest[_ngcontent-%COMP%]:hover{background-color:red;transition:.3s}.options[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.options[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{content:"";width:10px;height:10px;display:block;background:white;position:absolute;top:50%;left:50%;border-radius:50%;transform:translate(-50%,-50%) scale(0);transition:.3s ease-in-out 0s}.options[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background:#21bf73;transition:.3s ease-in-out 0s}.options[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{transform:translate(-50%,-50%) scale(1)}.checkboxmark[_ngcontent-%COMP%]{position:absolute;top:-1px;left:0;height:25px;width:25px;background-color:#555;border:1px solid #ddd}.options[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkboxmark[_ngcontent-%COMP%]:after{display:block}.options[_ngcontent-%COMP%]   .checkboxmark[_ngcontent-%COMP%]:after{content:"";width:10px;height:10px;display:block;background:white;position:absolute;top:50%;left:50%;border-radius:50%;transform:translate(-50%,-50%) scale(0);transition:.3s ease-in-out 0s}.options[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked ~ .checkboxmark[_ngcontent-%COMP%]{background:#21bf73;transition:.3s ease-in-out 0s}.options[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked ~ .checkboxmark[_ngcontent-%COMP%]:after{transform:translate(-50%,-50%) scale(1)}.btn-primary[_ngcontent-%COMP%]{background-color:#555;color:#ddd;border:1px solid #ddd}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#21bf73;border:1px solid #21bf73}.btn-success[_ngcontent-%COMP%]{padding:5px 25px;background-color:#21bf73}.container[_ngcontent-%COMP%]{margin:0 auto}@media (max-width: 576px){.question[_ngcontent-%COMP%]{width:100%;word-spacing:2px}}']}),r})();var j=g(7855),$e=g(5391),L=g(1244);function Re(r,e){1&r&&(n.TgZ(0,"tbody"),n.TgZ(1,"tr"),n.TgZ(2,"td",4),n._uU(3,"Hi\u1ec7n ch\u01b0a c\xf3 b\xe0i thi n\xe0o"),n.qZA(),n.qZA(),n.qZA())}const ee=function(r){return[r]};function Ne(r,e){if(1&r&&(n.TgZ(0,"tr"),n.TgZ(1,"td"),n._uU(2),n.qZA(),n.TgZ(3,"td"),n._uU(4),n.qZA(),n.TgZ(5,"td"),n._uU(6),n.qZA(),n.TgZ(7,"td"),n._uU(8),n.qZA(),n.TgZ(9,"td"),n._uU(10),n.qZA(),n.TgZ(11,"td"),n._uU(12),n.qZA(),n.TgZ(13,"td"),n._uU(14),n.qZA(),n.TgZ(15,"td"),n.TgZ(16,"a",6),n._uU(17," B\u1eaft \u0111\u1ea7u l\xe0m b\xe0i "),n.qZA(),n.TgZ(18,"a",7),n._uU(19," Xem \u0111i\u1ec3m "),n.qZA(),n.qZA(),n.qZA()),2&r){const t=e.$implicit;n.xp6(2),n.Oqu(t.testId),n.xp6(2),n.Oqu(t.title),n.xp6(2),n.Oqu(t.createBy),n.xp6(2),n.Oqu(null==t?null:t.startAt),n.xp6(2),n.Oqu(null==t?null:t.endAt),n.xp6(2),n.Oqu(t.time),n.xp6(2),n.Oqu(t.questionCount),n.xp6(2),n.Q6J("routerLink",n.VKq(9,ee,"/test/user-test/"+t.testId)),n.xp6(2),n.Q6J("routerLink",n.VKq(11,ee,"/test/user-point/"+t.testId))}}function He(r,e){if(1&r&&(n.TgZ(0,"tbody"),n.YNc(1,Ne,20,13,"tr",5),n.qZA()),2&r){const t=n.oxw();n.xp6(1),n.Q6J("ngForOf",t.test)}}function Fe(r,e){if(1&r){const t=n.EpF();n.TgZ(0,"div"),n.TgZ(1,"app-paging",8),n.NdJ("changePage",function(s){return n.CHM(t),n.oxw().ChangePageHandler(s)}),n.qZA(),n.qZA()}if(2&r){const t=n.oxw();n.xp6(1),n.Q6J("totalPage",t.TotalPage)("currentPage",t.urlQuery.pageNumber)}}let We=(()=>{class r{constructor(t){this.testServices=t,this.total=0,this.urlQuery=new W.e}ngOnInit(){this.getListTest(this.urlQuery.keyword)}getListTest(t){var o;this.urlQuery.keyword=t,this.testServices.GetListTestBrief(this.urlQuery).subscribe(s=>{var i;o=s,this.total=s,this.TotalPage=Math.ceil((null===(i=this.total.result)||void 0===i?void 0:i.total)/this.urlQuery.pageSize)},s=>{console.log(s.error.message)},()=>{console.log(o),this.test=o.result.items,this.total=o.result.total})}ChangePageHandler(t){this.urlQuery.pageNumber=t,this.getListTest(this.urlQuery.keyword)}}return r.\u0275fac=function(t){return new(t||r)(n.Y36(D.q))},r.\u0275cmp=n.Xpm({type:r,selectors:[["app-test"]],decls:27,vars:4,consts:[[2,"margin","80px 0 20px 410px","font-size","40px"],[3,"textSearch","search"],[1,"table-bordered","table-hover",2,"font-weight","500"],[4,"ngIf"],["colspan","3"],[4,"ngFor","ngForOf"],["routerLinkActive","router-link-active",1,"btn","btn-primary",3,"routerLink"],["routerLinkActive","router-link-active",1,"btn","btn-info",3,"routerLink"],[3,"totalPage","currentPage","changePage"]],template:function(t,o){1&t&&(n._UZ(0,"app-header-v2"),n.TgZ(1,"h2",0),n._uU(2,"Danh s\xe1ch b\xe0i thi"),n.qZA(),n.TgZ(3,"app-search",1),n.NdJ("search",function(i){return o.getListTest(i)}),n.qZA(),n.TgZ(4,"table",2),n.TgZ(5,"thead"),n.TgZ(6,"tr"),n.TgZ(7,"td"),n._uU(8,"Id"),n.qZA(),n.TgZ(9,"td"),n._uU(10,"Ti\xeau \u0111\u1ec1"),n.qZA(),n.TgZ(11,"td"),n._uU(12,"T\xe1c gi\u1ea3"),n.qZA(),n.TgZ(13,"td"),n._uU(14,"B\u1eaft \u0111\u1ea7u l\xfac"),n.qZA(),n.TgZ(15,"td"),n._uU(16,"K\u1ebft th\xfac l\xfac"),n.qZA(),n.TgZ(17,"td"),n._uU(18,"Th\u1eddi gian l\xe0m b\xe0i"),n.qZA(),n.TgZ(19,"td"),n._uU(20,"S\u1ed1 l\u01b0\u1ee3ng c\xe2u h\u1ecfi"),n.qZA(),n.TgZ(21,"td"),n._uU(22,"Thi"),n.qZA(),n.qZA(),n.qZA(),n.YNc(23,Re,4,0,"tbody",3),n.YNc(24,He,2,1,"tbody",3),n.qZA(),n.YNc(25,Fe,2,2,"div",3),n._UZ(26,"app-footer")),2&t&&(n.xp6(3),n.Q6J("textSearch",o.urlQuery.keyword),n.xp6(20),n.Q6J("ngIf",0==o.total),n.xp6(1),n.Q6J("ngIf",o.total>0),n.xp6(1),n.Q6J("ngIf",o.TotalPage>1))},directives:[j.V,$e.g,P.O5,L.c,P.sg,S.yS,S.Od,K.L],styles:["table[_ngcontent-%COMP%]{width:100%}tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-left:2%;padding-right:2%}table[_ngcontent-%COMP%]{font-weight:700;text-align:center;margin:auto}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{margin-top:10px;width:100%;padding:10px 0}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid black;text-align:center;margin-left:auto;margin-right:auto;padding:0 25px;font-size:15px}a[_ngcontent-%COMP%]{font-style:revert;font-size:15px;margin:5px -12px}.btn-primary[_ngcontent-%COMP%]{margin-right:20px;margin-left:-20px}.btn-info[_ngcontent-%COMP%]{margin-right:-25px}"]}),r})();var te=g(3456),ne=g(5209);let je=(()=>{class r{constructor(t,o,s,i){this.router=t,this.testService=o,this.activeRoute=s,this.notificationService=i}ngOnInit(){this.GetPoint()}GetPoint(){this.activeRoute.params.subscribe(t=>{this.testId=t.testId,console.log(this.testId)}),this.testService.GetUserTestPoint(this.testId).subscribe(t=>{this.pointData=t,console.log(this.pointData)},t=>{console.log(t.error.message),this.notificationService.info("B\u1ea1n ch\u01b0a l\xe0m \u0111\u1ec1 thi n\xe0y")},()=>{})}close(){window.close()}}return r.\u0275fac=function(t){return new(t||r)(n.Y36(S.F0),n.Y36(D.q),n.Y36(S.gz),n.Y36(te.g))},r.\u0275cmp=n.Xpm({type:r,selectors:[["app-user-point"]],decls:55,vars:9,consts:[[1,"container"],[1,"content"],[1,"info"],[1,"head"],[1,"btn","btn-info",3,"click"]],template:function(t,o){1&t&&(n._UZ(0,"app-header-v2"),n._UZ(1,"app-notification"),n.TgZ(2,"div"),n.TgZ(3,"div",0),n.TgZ(4,"div",1),n.TgZ(5,"fieldset"),n.TgZ(6,"legend"),n.TgZ(7,"h3"),n._uU(8,"K\u1ebft qu\u1ea3 thi"),n.qZA(),n.qZA(),n.TgZ(9,"ul"),n.TgZ(10,"li"),n.TgZ(11,"h4"),n._uU(12,"\u0110\u1ec1 thi:"),n.qZA(),n._uU(13),n.qZA(),n.TgZ(14,"li"),n.TgZ(15,"h4"),n._uU(16,"Th\u1eddi gian b\u1eaft \u0111\u1ea7u: "),n.qZA(),n._uU(17),n.qZA(),n.TgZ(18,"li"),n.TgZ(19,"h4"),n._uU(20,"Th\u1eddi gian k\u1ebft th\xfac:"),n.qZA(),n._uU(21),n.qZA(),n.TgZ(22,"li"),n.TgZ(23,"h4"),n._uU(24,"S\u1ed1 c\xe2u h\u1ecfi:"),n.qZA(),n._uU(25),n.qZA(),n.TgZ(26,"li"),n.TgZ(27,"h4"),n._uU(28,"Gi\xe1o vi\xean:"),n.qZA(),n._uU(29),n.qZA(),n.TgZ(30,"li"),n.TgZ(31,"h4"),n._uU(32,"Th\u1eddi gian l\xe0m b\xe0i:"),n.qZA(),n._uU(33),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(34,"div",2),n.TgZ(35,"p"),n._uU(36,"Th\xf4ng tin sinh vi\xean:"),n.qZA(),n.TgZ(37,"table"),n.TgZ(38,"tr",3),n.TgZ(39,"td"),n._uU(40,"L\u1edbp"),n.qZA(),n.TgZ(41,"td"),n._uU(42,"T\xean"),n.qZA(),n.TgZ(43,"td"),n._uU(44,"\u0110i\u1ec3m"),n.qZA(),n.qZA(),n.TgZ(45,"tr"),n.TgZ(46,"td"),n._uU(47),n.qZA(),n.TgZ(48,"td"),n._uU(49),n.qZA(),n.TgZ(50,"td"),n._uU(51),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(52,"button",4),n.NdJ("click",function(){return o.close()}),n._uU(53,"OK"),n.qZA(),n.qZA(),n._UZ(54,"app-footer"),n.qZA()),2&t&&(n.xp6(13),n.hij(" ",o.pointData.result.data.test.title," "),n.xp6(4),n.hij(" ",o.pointData.result.data.test.startAt," "),n.xp6(4),n.hij(" ",o.pointData.result.data.test.endAt," "),n.xp6(4),n.hij(" ",o.pointData.result.data.test.questionCount," "),n.xp6(4),n.hij(" ",o.pointData.result.data.test.createBy," "),n.xp6(4),n.hij(" ",o.pointData.result.data.test.time," ph\xfat "),n.xp6(14),n.Oqu(o.pointData.result.data.userPoint.className),n.xp6(2),n.Oqu(o.pointData.result.data.userPoint.userName),n.xp6(2),n.hij("",o.pointData.result.data.userPoint.point,"/10"))},directives:[j.V,ne.c,L.c],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}body[_ngcontent-%COMP%]{background:white}.container[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif;padding-left:50px}fieldset[_ngcontent-%COMP%], legend[_ngcontent-%COMP%]{border:5px solid #3e630e;padding:1px 10px;margin:5px;font-size:12px}legend[_ngcontent-%COMP%]{width:40%}h3[_ngcontent-%COMP%]{text-transform:uppercase;font-size:24px;text-align:center;margin:10px 0;color:#00f}.content[_ngcontent-%COMP%]{width:50%;box-shadow:20px 18px 5px 5px #767e878f;-webkit-box-shadow:20px 18px 5px 5px rgba(118,126,135,.56);-moz-box-shadow:20px 18px 5px 5px rgba(118,126,135,.56)}.content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;font-size:18px}.content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:10px 5px;display:flex}.content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{text-transform:uppercase;margin-right:10px;color:#00f}.info[_ngcontent-%COMP%]{padding:20px 0}.info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:20px;text-transform:uppercase;font-weight:700;margin:20px 0;color:#00f}table[_ngcontent-%COMP%]{width:50%}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:2px solid blue;text-align:center;line-height:32px}.head[_ngcontent-%COMP%]{font-weight:700}a[_ngcontent-%COMP%]{text-transform:uppercase;font-size:16px;font-weight:700;color:#3d3c3c}a[_ngcontent-%COMP%]:hover{color:red;cursor:pointer}button[_ngcontent-%COMP%]{width:10em;height:2em}"]}),r})();var oe=g(1832);const Le=[0,2e3,1e4,3e4,null];class re{constructor(e){this._retryDelays=void 0!==e?[...e,null]:Le}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}function se(r,e,t,o,s,i,a){try{var l=r[i](a),u=l.value}catch(h){return void t(h)}l.done?e(u):Promise.resolve(u).then(o,s)}function f(r){return function(){var e=this,t=arguments;return new Promise(function(o,s){var i=r.apply(e,t);function a(u){se(i,o,s,a,l,"next",u)}function l(u){se(i,o,s,a,l,"throw",u)}a(void 0)})}}class Z extends Error{constructor(e,t){const o=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=o}}class B extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class O extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class Be extends Error{constructor(e,t){const o=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=o}}class Je extends Error{constructor(e,t){const o=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=o}}class Qe extends Error{constructor(e,t){const o=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=o}}class ze extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class Ye extends Error{constructor(e,t){const o=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=o}}class ie{constructor(e,t,o){this.statusCode=e,this.statusText=t,this.content=o}}class J{get(e,t){return this.send($(b({},t),{method:"GET",url:e}))}post(e,t){return this.send($(b({},t),{method:"POST",url:e}))}delete(e,t){return this.send($(b({},t),{method:"DELETE",url:e}))}getCookieString(e){return""}}var c=(()=>{return(r=c||(c={}))[r.Trace=0]="Trace",r[r.Debug=1]="Debug",r[r.Information=2]="Information",r[r.Warning=3]="Warning",r[r.Error=4]="Error",r[r.Critical=5]="Critical",r[r.None=6]="None",c;var r})();class M{constructor(){}log(e,t){}}M.instance=new M;class C{static isRequired(e,t){if(null==e)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,o){if(!(e in t))throw new Error(`Unknown ${o} value: ${e}.`)}}class w{static get isBrowser(){return"object"==typeof window}static get isWebWorker(){return"object"==typeof self&&"importScripts"in self}static get isNode(){return!this.isBrowser&&!this.isWebWorker}}function U(r,e){let t="";return Q(r)?(t=`Binary data of length ${r.byteLength}`,e&&(t+=`. Content: '${function(r){const e=new Uint8Array(r);let t="";return e.forEach(o=>{t+=`0x${o<16?"0":""}${o.toString(16)} `}),t.substr(0,t.length-1)}(r)}'`)):"string"==typeof r&&(t=`String data of length ${r.length}`,e&&(t+=`. Content: '${r}'`)),t}function Q(r){return r&&"undefined"!=typeof ArrayBuffer&&(r instanceof ArrayBuffer||r.constructor&&"ArrayBuffer"===r.constructor.name)}function ce(r,e,t,o,s,i,a){return z.apply(this,arguments)}function z(){return(z=f(function*(r,e,t,o,s,i,a){let l={};if(s){const A=yield s();A&&(l={Authorization:`Bearer ${A}`})}const[u,h]=I();l[u]=h,r.log(c.Trace,`(${e} transport) sending data. ${U(i,a.logMessageContent)}.`);const d=Q(i)?"arraybuffer":"text",x=yield t.post(o,{content:i,headers:b(b({},l),a.headers),responseType:d,timeout:a.timeout,withCredentials:a.withCredentials});r.log(c.Trace,`(${e} transport) request complete. Response status: ${x.statusCode}.`)})).apply(this,arguments)}class Ke{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}}class H{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const o=`[${(new Date).toISOString()}] ${c[e]}: ${t}`;switch(e){case c.Critical:case c.Error:this.out.error(o);break;case c.Warning:this.out.warn(o);break;case c.Information:this.out.info(o);break;default:this.out.log(o)}}}}function I(){let r="X-SignalR-User-Agent";return w.isNode&&(r="User-Agent"),[r,et("6.0.0",tt(),w.isNode?"NodeJS":"Browser",nt())]}function et(r,e,t,o){let s="Microsoft SignalR/";const i=r.split(".");return s+=`${i[0]}.${i[1]}`,s+=` (${r}; `,s+=e&&""!==e?`${e}; `:"Unknown OS; ",s+=`${t}`,s+=o?`; ${o}`:"; Unknown Runtime Version",s+=")",s}function tt(){if(!w.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function nt(){if(w.isNode)return process.versions.node}function ae(r){return r.stack?r.stack:r.message?r.message:`${r}`}class st extends J{constructor(e){if(super(),this._logger=e,"undefined"==typeof fetch){const t=require;this._jar=new(t("tough-cookie").CookieJar),this._fetchType=t("node-fetch"),this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("could not find global")}());if("undefined"==typeof AbortController){const t=require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}send(e){var t=this;return f(function*(){if(e.abortSignal&&e.abortSignal.aborted)throw new O;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const o=new t._abortControllerType;let s;e.abortSignal&&(e.abortSignal.onabort=()=>{o.abort(),s=new O});let a,i=null;e.timeout&&(i=setTimeout(()=>{o.abort(),t._logger.log(c.Warning,"Timeout from HTTP request."),s=new B},e.timeout));try{a=yield t._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:b({"Content-Type":"text/plain;charset=UTF-8","X-Requested-With":"XMLHttpRequest"},e.headers),method:e.method,mode:"cors",redirect:"follow",signal:o.signal})}catch(h){throw s||(t._logger.log(c.Warning,`Error from HTTP request. ${h}.`),h)}finally{i&&clearTimeout(i),e.abortSignal&&(e.abortSignal.onabort=null)}if(!a.ok){const h=yield le(a,"text");throw new Z(h||a.statusText,a.status)}const u=yield le(a,e.responseType);return new ie(a.status,a.statusText,u)})()}getCookieString(e){let t="";return w.isNode&&this._jar&&this._jar.getCookies(e,(o,s)=>t=s.join("; ")),t}}function le(r,e){let t;switch(e){case"arraybuffer":t=r.arrayBuffer();break;default:t=r.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`)}return t}class it extends J{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new O):e.method?e.url?new Promise((t,o)=>{const s=new XMLHttpRequest;s.open(e.method,e.url,!0),s.withCredentials=void 0===e.withCredentials||e.withCredentials,s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("Content-Type","text/plain;charset=UTF-8");const i=e.headers;i&&Object.keys(i).forEach(a=>{s.setRequestHeader(a,i[a])}),e.responseType&&(s.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{s.abort(),o(new O)}),e.timeout&&(s.timeout=e.timeout),s.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),s.status>=200&&s.status<300?t(new ie(s.status,s.statusText,s.response||s.responseText)):o(new Z(s.response||s.responseText||s.statusText,s.status))},s.onerror=()=>{this._logger.log(c.Warning,`Error from HTTP request. ${s.status}: ${s.statusText}.`),o(new Z(s.statusText,s.status))},s.ontimeout=()=>{this._logger.log(c.Warning,"Timeout from HTTP request."),o(new B)},s.send(e.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class ct extends J{constructor(e){if(super(),"undefined"!=typeof fetch||w.isNode)this._httpClient=new st(e);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");this._httpClient=new it(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new O):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}let q=(()=>{class r{}return r.Authorization="Authorization",r.Cookie="Cookie",r})();var m=(()=>{return(r=m||(m={}))[r.None=0]="None",r[r.WebSockets=1]="WebSockets",r[r.ServerSentEvents=2]="ServerSentEvents",r[r.LongPolling=4]="LongPolling",m;var r})(),v=(()=>{return(r=v||(v={}))[r.Text=1]="Text",r[r.Binary=2]="Binary",v;var r})();class at{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class ue{constructor(e,t,o,s){this._httpClient=e,this._accessTokenFactory=t,this._logger=o,this._pollAbort=new at,this._options=s,this._running=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this._pollAbort.aborted}connect(e,t){var o=this;return f(function*(){if(C.isRequired(e,"url"),C.isRequired(t,"transferFormat"),C.isIn(t,v,"transferFormat"),o._url=e,o._logger.log(c.Trace,"(LongPolling transport) Connecting."),t===v.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[s,i]=I(),a=b({[s]:i},o._options.headers),l={abortSignal:o._pollAbort.signal,headers:a,timeout:1e5,withCredentials:o._options.withCredentials};t===v.Binary&&(l.responseType="arraybuffer");const u=yield o._getAccessToken();o._updateHeaderToken(l,u);const h=`${e}&_=${Date.now()}`;o._logger.log(c.Trace,`(LongPolling transport) polling: ${h}.`);const d=yield o._httpClient.get(h,l);200!==d.statusCode?(o._logger.log(c.Error,`(LongPolling transport) Unexpected response code: ${d.statusCode}.`),o._closeError=new Z(d.statusText||"",d.statusCode),o._running=!1):o._running=!0,o._receiving=o._poll(o._url,l)})()}_getAccessToken(){var e=this;return f(function*(){return e._accessTokenFactory?yield e._accessTokenFactory():null})()}_updateHeaderToken(e,t){e.headers||(e.headers={}),t?e.headers[q.Authorization]=`Bearer ${t}`:e.headers[q.Authorization]&&delete e.headers[q.Authorization]}_poll(e,t){var o=this;return f(function*(){try{for(;o._running;){const s=yield o._getAccessToken();o._updateHeaderToken(t,s);try{const i=`${e}&_=${Date.now()}`;o._logger.log(c.Trace,`(LongPolling transport) polling: ${i}.`);const a=yield o._httpClient.get(i,t);204===a.statusCode?(o._logger.log(c.Information,"(LongPolling transport) Poll terminated by server."),o._running=!1):200!==a.statusCode?(o._logger.log(c.Error,`(LongPolling transport) Unexpected response code: ${a.statusCode}.`),o._closeError=new Z(a.statusText||"",a.statusCode),o._running=!1):a.content?(o._logger.log(c.Trace,`(LongPolling transport) data received. ${U(a.content,o._options.logMessageContent)}.`),o.onreceive&&o.onreceive(a.content)):o._logger.log(c.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(i){o._running?i instanceof B?o._logger.log(c.Trace,"(LongPolling transport) Poll timed out, reissuing."):(o._closeError=i,o._running=!1):o._logger.log(c.Trace,`(LongPolling transport) Poll errored after shutdown: ${i.message}`)}}}finally{o._logger.log(c.Trace,"(LongPolling transport) Polling complete."),o.pollAborted||o._raiseOnClose()}})()}send(e){var t=this;return f(function*(){return t._running?ce(t._logger,"LongPolling",t._httpClient,t._url,t._accessTokenFactory,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){var e=this;return f(function*(){e._logger.log(c.Trace,"(LongPolling transport) Stopping polling."),e._running=!1,e._pollAbort.abort();try{yield e._receiving,e._logger.log(c.Trace,`(LongPolling transport) sending DELETE request to ${e._url}.`);const t={},[o,s]=I();t[o]=s;const i={headers:b(b({},t),e._options.headers),timeout:e._options.timeout,withCredentials:e._options.withCredentials},a=yield e._getAccessToken();e._updateHeaderToken(i,a),yield e._httpClient.delete(e._url,i),e._logger.log(c.Trace,"(LongPolling transport) DELETE request sent.")}finally{e._logger.log(c.Trace,"(LongPolling transport) Stop finished."),e._raiseOnClose()}})()}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(c.Trace,e),this.onclose(this._closeError)}}}class lt{constructor(e,t,o,s){this._httpClient=e,this._accessTokenFactory=t,this._logger=o,this._options=s,this.onreceive=null,this.onclose=null}connect(e,t){var o=this;return f(function*(){if(C.isRequired(e,"url"),C.isRequired(t,"transferFormat"),C.isIn(t,v,"transferFormat"),o._logger.log(c.Trace,"(SSE transport) Connecting."),o._url=e,o._accessTokenFactory){const s=yield o._accessTokenFactory();s&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(s)}`)}return new Promise((s,i)=>{let l,a=!1;if(t===v.Text){if(w.isBrowser||w.isWebWorker)l=new o._options.EventSource(e,{withCredentials:o._options.withCredentials});else{const u=o._httpClient.getCookieString(e),h={};h.Cookie=u;const[d,x]=I();h[d]=x,l=new o._options.EventSource(e,{withCredentials:o._options.withCredentials,headers:b(b({},h),o._options.headers)})}try{l.onmessage=u=>{if(o.onreceive)try{o._logger.log(c.Trace,`(SSE transport) data received. ${U(u.data,o._options.logMessageContent)}.`),o.onreceive(u.data)}catch(h){return void o._close(h)}},l.onerror=u=>{a?o._close():i(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},l.onopen=()=>{o._logger.log(c.Information,`SSE connected to ${o._url}`),o._eventSource=l,a=!0,s()}}catch(u){return void i(u)}}else i(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})})()}send(e){var t=this;return f(function*(){return t._eventSource?ce(t._logger,"SSE",t._httpClient,t._url,t._accessTokenFactory,e,t._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class ut{constructor(e,t,o,s,i,a){this._logger=o,this._accessTokenFactory=t,this._logMessageContent=s,this._webSocketConstructor=i,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=a}connect(e,t){var o=this;return f(function*(){if(C.isRequired(e,"url"),C.isRequired(t,"transferFormat"),C.isIn(t,v,"transferFormat"),o._logger.log(c.Trace,"(WebSockets transport) Connecting."),o._accessTokenFactory){const s=yield o._accessTokenFactory();s&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(s)}`)}return new Promise((s,i)=>{let a;e=e.replace(/^http/,"ws");const l=o._httpClient.getCookieString(e);let u=!1;if(w.isNode){const h={},[d,x]=I();h[d]=x,l&&(h[q.Cookie]=`${l}`),a=new o._webSocketConstructor(e,void 0,{headers:b(b({},h),o._headers)})}a||(a=new o._webSocketConstructor(e)),t===v.Binary&&(a.binaryType="arraybuffer"),a.onopen=h=>{o._logger.log(c.Information,`WebSocket connected to ${e}.`),o._webSocket=a,u=!0,s()},a.onerror=h=>{let d=null;d="undefined"!=typeof ErrorEvent&&h instanceof ErrorEvent?h.error:"There was an error with the transport",o._logger.log(c.Information,`(WebSockets transport) ${d}.`)},a.onmessage=h=>{if(o._logger.log(c.Trace,`(WebSockets transport) data received. ${U(h.data,o._logMessageContent)}.`),o.onreceive)try{o.onreceive(h.data)}catch(d){return void o._close(d)}},a.onclose=h=>{if(u)o._close(h);else{let d=null;d="undefined"!=typeof ErrorEvent&&h instanceof ErrorEvent?h.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",i(new Error(d))}}})})()}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(c.Trace,`(WebSockets transport) sending data. ${U(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(c.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&"boolean"==typeof e.wasClean&&"number"==typeof e.code}}class ht{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,C.isRequired(e,"url"),this._logger=void 0===(r=t.logger)?new H(c.Information):null===r?M.instance:void 0!==r.log?r:new H(r),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=void 0!==t.logMessageContent&&t.logMessageContent,"boolean"!=typeof t.withCredentials&&void 0!==t.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");var r;t.withCredentials=void 0===t.withCredentials||t.withCredentials,t.timeout=void 0===t.timeout?1e5:t.timeout;let o=null,s=null;if(w.isNode){const i=require;o=i("ws"),s=i("eventsource")}w.isNode||"undefined"==typeof WebSocket||t.WebSocket?w.isNode&&!t.WebSocket&&o&&(t.WebSocket=o):t.WebSocket=WebSocket,w.isNode||"undefined"==typeof EventSource||t.EventSource?w.isNode&&!t.EventSource&&void 0!==s&&(t.EventSource=s):t.EventSource=EventSource,this._httpClient=t.httpClient||new ct(this._logger),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}start(e){var t=this;return f(function*(){if(C.isIn(e=e||v.Binary,v,"transferFormat"),t._logger.log(c.Debug,`Starting connection with transfer format '${v[e]}'.`),"Disconnected"!==t._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(t._connectionState="Connecting",t._startInternalPromise=t._startInternal(e),yield t._startInternalPromise,"Disconnecting"===t._connectionState){const o="Failed to start the HttpConnection before stop() was called.";return t._logger.log(c.Error,o),yield t._stopPromise,Promise.reject(new Error(o))}if("Connected"!==t._connectionState){const o="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return t._logger.log(c.Error,o),Promise.reject(new Error(o))}t._connectionStarted=!0})()}send(e){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new Y(this.transport)),this._sendQueue.send(e))}stop(e){var t=this;return f(function*(){return"Disconnected"===t._connectionState?(t._logger.log(c.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===t._connectionState?(t._logger.log(c.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),t._stopPromise):(t._connectionState="Disconnecting",t._stopPromise=new Promise(o=>{t._stopPromiseResolver=o}),yield t._stopInternal(e),void(yield t._stopPromise))})()}_stopInternal(e){var t=this;return f(function*(){t._stopError=e;try{yield t._startInternalPromise}catch(o){}if(t.transport){try{yield t.transport.stop()}catch(o){t._logger.log(c.Error,`HttpConnection.transport.stop() threw error '${o}'.`),t._stopConnection()}t.transport=void 0}else t._logger.log(c.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")})()}_startInternal(e){var t=this;return f(function*(){let o=t.baseUrl;t._accessTokenFactory=t._options.accessTokenFactory;try{if(t._options.skipNegotiation){if(t._options.transport!==m.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");t.transport=t._constructTransport(m.WebSockets),yield t._startTransport(o,e)}else{let s=null,i=0;do{if(s=yield t._getNegotiationResponse(o),"Disconnecting"===t._connectionState||"Disconnected"===t._connectionState)throw new Error("The connection was stopped during negotiation.");if(s.error)throw new Error(s.error);if(s.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(s.url&&(o=s.url),s.accessToken){const a=s.accessToken;t._accessTokenFactory=()=>a}i++}while(s.url&&i<100);if(100===i&&s.url)throw new Error("Negotiate redirection limit exceeded.");yield t._createTransport(o,t._options.transport,s,e)}t.transport instanceof ue&&(t.features.inherentKeepAlive=!0),"Connecting"===t._connectionState&&(t._logger.log(c.Debug,"The HttpConnection connected successfully."),t._connectionState="Connected")}catch(s){return t._logger.log(c.Error,"Failed to start the connection: "+s),t._connectionState="Disconnected",t.transport=void 0,t._stopPromiseResolver(),Promise.reject(s)}})()}_getNegotiationResponse(e){var t=this;return f(function*(){const o={};if(t._accessTokenFactory){const l=yield t._accessTokenFactory();l&&(o[q.Authorization]=`Bearer ${l}`)}const[s,i]=I();o[s]=i;const a=t._resolveNegotiateUrl(e);t._logger.log(c.Debug,`Sending negotiation request: ${a}.`);try{const l=yield t._httpClient.post(a,{content:"",headers:b(b({},o),t._options.headers),timeout:t._options.timeout,withCredentials:t._options.withCredentials});if(200!==l.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${l.statusCode}'`));const u=JSON.parse(l.content);return(!u.negotiateVersion||u.negotiateVersion<1)&&(u.connectionToken=u.connectionId),u}catch(l){let u="Failed to complete negotiation with the server: "+l;return l instanceof Z&&404===l.statusCode&&(u+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),t._logger.log(c.Error,u),Promise.reject(new ze(u))}})()}_createConnectUrl(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+`id=${t}`:e}_createTransport(e,t,o,s){var i=this;return f(function*(){let a=i._createConnectUrl(e,o.connectionToken);if(i._isITransport(t))return i._logger.log(c.Debug,"Connection was provided an instance of ITransport, using that directly."),i.transport=t,yield i._startTransport(a,s),void(i.connectionId=o.connectionId);const l=[],u=o.availableTransports||[];let h=o;for(const d of u){const x=i._resolveTransportOrError(d,t,s);if(x instanceof Error)l.push(`${d.transport} failed:`),l.push(x);else if(i._isITransport(x)){if(i.transport=x,!h){try{h=yield i._getNegotiationResponse(e)}catch(A){return Promise.reject(A)}a=i._createConnectUrl(e,h.connectionToken)}try{return yield i._startTransport(a,s),void(i.connectionId=h.connectionId)}catch(A){if(i._logger.log(c.Error,`Failed to start the transport '${d.transport}': ${A}`),h=void 0,l.push(new Qe(`${d.transport} failed: ${A}`,m[d.transport])),"Connecting"!==i._connectionState){const de="Failed to select transport before stop() was called.";return i._logger.log(c.Debug,de),Promise.reject(new Error(de))}}}}return Promise.reject(l.length>0?new Ye(`Unable to connect to the server with any of the available transports. ${l.join(" ")}`,l):new Error("None of the transports supported by the client are supported by the server."))})()}_constructTransport(e){switch(e){case m.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new ut(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case m.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new lt(this._httpClient,this._accessTokenFactory,this._logger,this._options);case m.LongPolling:return new ue(this._httpClient,this._accessTokenFactory,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.transport.onclose=o=>this._stopConnection(o),this.transport.connect(e,t)}_resolveTransportOrError(e,t,o){const s=m[e.transport];if(null==s)return this._logger.log(c.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function(r,e){return!r||0!=(e&r)}(t,s))return this._logger.log(c.Debug,`Skipping transport '${m[s]}' because it was disabled by the client.`),new Je(`'${m[s]}' is disabled by the client.`,s);if(!(e.transferFormats.map(a=>v[a]).indexOf(o)>=0))return this._logger.log(c.Debug,`Skipping transport '${m[s]}' because it does not support the requested transfer format '${v[o]}'.`),new Error(`'${m[s]}' does not support ${v[o]}.`);if(s===m.WebSockets&&!this._options.WebSocket||s===m.ServerSentEvents&&!this._options.EventSource)return this._logger.log(c.Debug,`Skipping transport '${m[s]}' because it is not supported in your environment.'`),new Be(`'${m[s]}' is not supported in your environment.`,s);this._logger.log(c.Debug,`Selecting transport '${m[s]}'.`);try{return this._constructTransport(s)}catch(a){return a}}_isITransport(e){return e&&"object"==typeof e&&"connect"in e}_stopConnection(e){if(this._logger.log(c.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(c.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),e?this._logger.log(c.Error,`Connection disconnected with error '${e}'.`):this._logger.log(c.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(c.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(c.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(c.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!w.isBrowser||!window.document)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(c.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=e.indexOf("?");let o=e.substring(0,-1===t?e.length:t);return"/"!==o[o.length-1]&&(o+="/"),o+="negotiate",o+=-1===t?"":e.substring(t),-1===o.indexOf("negotiateVersion")&&(o+=-1===t?"?":"&",o+="negotiateVersion="+this._negotiateVersion),o}}class Y{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new F,this._transportResult=new F,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new F),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}_sendLoop(){var e=this;return f(function*(){for(;;){if(yield e._sendBufferedData.promise,!e._executing){e._transportResult&&e._transportResult.reject("Connection stopped.");break}e._sendBufferedData=new F;const t=e._transportResult;e._transportResult=void 0;const o="string"==typeof e._buffer[0]?e._buffer.join(""):Y._concatBuffers(e._buffer);e._buffer.length=0;try{yield e._transport.send(o),t.resolve()}catch(s){t.reject(s)}}})()}static _concatBuffers(e){const t=e.map(i=>i.byteLength).reduce((i,a)=>i+a),o=new Uint8Array(t);let s=0;for(const i of e)o.set(new Uint8Array(i),s),s+=i.byteLength;return o.buffer}}class F{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}class y{static write(e){return`${e}${y.RecordSeparator}`}static parse(e){if(e[e.length-1]!==y.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(y.RecordSeparator);return t.pop(),t}}y.RecordSeparatorCode=30,y.RecordSeparator=String.fromCharCode(y.RecordSeparatorCode);class gt{writeHandshakeRequest(e){return y.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,o;if(Q(e)){const l=new Uint8Array(e),u=l.indexOf(y.RecordSeparatorCode);if(-1===u)throw new Error("Message is incomplete.");const h=u+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(l.slice(0,h))),o=l.byteLength>h?l.slice(h).buffer:null}else{const l=e,u=l.indexOf(y.RecordSeparator);if(-1===u)throw new Error("Message is incomplete.");const h=u+1;t=l.substring(0,h),o=l.length>h?l.substring(h):null}const s=y.parse(t),i=JSON.parse(s[0]);if(i.type)throw new Error("Expected a handshake response from the server.");return[o,i]}}var p=(()=>{return(r=p||(p={}))[r.Invocation=1]="Invocation",r[r.StreamItem=2]="StreamItem",r[r.Completion=3]="Completion",r[r.StreamInvocation=4]="StreamInvocation",r[r.CancelInvocation=5]="CancelInvocation",r[r.Ping=6]="Ping",r[r.Close=7]="Close",p;var r})();class pt{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new Ke(this,e)}}var _=(()=>{return(r=_||(_={})).Disconnected="Disconnected",r.Connecting="Connecting",r.Connected="Connected",r.Disconnecting="Disconnecting",r.Reconnecting="Reconnecting",_;var r})();class V{constructor(e,t,o,s){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(c.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},C.isRequired(e,"connection"),C.isRequired(t,"logger"),C.isRequired(o,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this._logger=t,this._protocol=o,this.connection=e,this._reconnectPolicy=s,this._handshakeProtocol=new gt,this.connection.onreceive=i=>this._processIncomingData(i),this.connection.onclose=i=>this._connectionClosed(i),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=_.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:p.Ping})}static create(e,t,o,s){return new V(e,t,o,s)}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==_.Disconnected&&this._connectionState!==_.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}_startWithStateTransitions(){var e=this;return f(function*(){if(e._connectionState!==_.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));e._connectionState=_.Connecting,e._logger.log(c.Debug,"Starting HubConnection.");try{yield e._startInternal(),w.isBrowser&&document&&document.addEventListener("freeze",e._freezeEventListener),e._connectionState=_.Connected,e._connectionStarted=!0,e._logger.log(c.Debug,"HubConnection connected successfully.")}catch(t){return e._connectionState=_.Disconnected,e._logger.log(c.Debug,`HubConnection failed to start successfully because of error '${t}'.`),Promise.reject(t)}})()}_startInternal(){var e=this;return f(function*(){e._stopDuringStartError=void 0,e._receivedHandshakeResponse=!1;const t=new Promise((o,s)=>{e._handshakeResolver=o,e._handshakeRejecter=s});yield e.connection.start(e._protocol.transferFormat);try{const o={protocol:e._protocol.name,version:e._protocol.version};if(e._logger.log(c.Debug,"Sending handshake request."),yield e._sendMessage(e._handshakeProtocol.writeHandshakeRequest(o)),e._logger.log(c.Information,`Using HubProtocol '${e._protocol.name}'.`),e._cleanupTimeout(),e._resetTimeoutPeriod(),e._resetKeepAliveInterval(),yield t,e._stopDuringStartError)throw e._stopDuringStartError}catch(o){throw e._logger.log(c.Debug,`Hub handshake failed with error '${o}' during start(). Stopping HubConnection.`),e._cleanupTimeout(),e._cleanupPingTimer(),yield e.connection.stop(o),o}})()}stop(){var e=this;return f(function*(){const t=e._startPromise;e._stopPromise=e._stopInternal(),yield e._stopPromise;try{yield t}catch(o){}})()}_stopInternal(e){return this._connectionState===_.Disconnected?(this._logger.log(c.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve()):this._connectionState===_.Disconnecting?(this._logger.log(c.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState=_.Disconnecting,this._logger.log(c.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(c.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(e)))}stream(e,...t){const[o,s]=this._replaceStreamingParams(t),i=this._createStreamInvocation(e,t,s);let a;const l=new pt;return l.cancelCallback=()=>{const u=this._createCancelInvocation(i.invocationId);return delete this._callbacks[i.invocationId],a.then(()=>this._sendWithProtocol(u))},this._callbacks[i.invocationId]=(u,h)=>{h?l.error(h):u&&(u.type===p.Completion?u.error?l.error(new Error(u.error)):l.complete():l.next(u.item))},a=this._sendWithProtocol(i).catch(u=>{l.error(u),delete this._callbacks[i.invocationId]}),this._launchStreams(o,a),l}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[o,s]=this._replaceStreamingParams(t),i=this._sendWithProtocol(this._createInvocation(e,t,!0,s));return this._launchStreams(o,i),i}invoke(e,...t){const[o,s]=this._replaceStreamingParams(t),i=this._createInvocation(e,t,!1,s);return new Promise((l,u)=>{this._callbacks[i.invocationId]=(d,x)=>{x?u(x):d&&(d.type===p.Completion?d.error?u(new Error(d.error)):l(d.result):u(new Error(`Unexpected message type: ${d.type}`)))};const h=this._sendWithProtocol(i).catch(d=>{u(d),delete this._callbacks[i.invocationId]});this._launchStreams(o,h)})}on(e,t){!e||!t||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),-1===this._methods[e].indexOf(t)&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const o=this._methods[e];if(o)if(t){const s=o.indexOf(t);-1!==s&&(o.splice(s,1),0===o.length&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const o of t)switch(o.type){case p.Invocation:this._invokeClientMethod(o);break;case p.StreamItem:case p.Completion:{const s=this._callbacks[o.invocationId];if(s){o.type===p.Completion&&delete this._callbacks[o.invocationId];try{s(o)}catch(i){this._logger.log(c.Error,`Stream callback threw error: ${ae(i)}`)}}break}case p.Ping:break;case p.Close:{this._logger.log(c.Information,"Close message received from server.");const s=o.error?new Error("Server returned an error on close: "+o.error):void 0;!0===o.allowReconnect?this.connection.stop(s):this._stopPromise=this._stopInternal(s);break}default:this._logger.log(c.Warning,`Invalid message type: ${o.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,o;try{[o,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(s){const i="Error parsing handshake response: "+s;this._logger.log(c.Error,i);const a=new Error(i);throw this._handshakeRejecter(a),a}if(t.error){const s="Server returned handshake error: "+t.error;this._logger.log(c.Error,s);const i=new Error(s);throw this._handshakeRejecter(i),i}return this._logger.log(c.Debug,"Server handshake complete."),this._handshakeResolver(),o}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){var e=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let t=this._nextKeepAlive-(new Date).getTime();t<0&&(t=0),this._pingServerHandle=setTimeout(f(function*(){if(e._connectionState===_.Connected)try{yield e._sendMessage(e._cachedPingMessage)}catch(o){e._cleanupPingTimer()}}),t)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}_invokeClientMethod(e){const t=this._methods[e.target.toLowerCase()];if(t){try{t.forEach(o=>o.apply(this,e.arguments))}catch(o){this._logger.log(c.Error,`A callback for the method ${e.target.toLowerCase()} threw error '${o}'.`)}if(e.invocationId){const o="Server requested a response, which is not supported in this version of the client.";this._logger.log(c.Error,o),this._stopPromise=this._stopInternal(new Error(o))}}else this._logger.log(c.Warning,`No client method with the name '${e.target}' found.`)}_connectionClosed(e){this._logger.log(c.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new Error("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===_.Disconnecting?this._completeClose(e):this._connectionState===_.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===_.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=_.Disconnected,this._connectionStarted=!1,w.isBrowser&&document&&document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log(c.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}_reconnect(e){var t=this;return f(function*(){const o=Date.now();let s=0,i=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),a=t._getNextRetryDelay(s++,0,i);if(null===a)return t._logger.log(c.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void t._completeClose(e);if(t._connectionState=_.Reconnecting,t._logger.log(c.Information,e?`Connection reconnecting because of error '${e}'.`:"Connection reconnecting."),0!==t._reconnectingCallbacks.length){try{t._reconnectingCallbacks.forEach(l=>l.apply(t,[e]))}catch(l){t._logger.log(c.Error,`An onreconnecting callback called with error '${e}' threw error '${l}'.`)}if(t._connectionState!==_.Reconnecting)return void t._logger.log(c.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==a;){if(t._logger.log(c.Information,`Reconnect attempt number ${s} will start in ${a} ms.`),yield new Promise(l=>{t._reconnectDelayHandle=setTimeout(l,a)}),t._reconnectDelayHandle=void 0,t._connectionState!==_.Reconnecting)return void t._logger.log(c.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(yield t._startInternal(),t._connectionState=_.Connected,t._logger.log(c.Information,"HubConnection reconnected successfully."),0!==t._reconnectedCallbacks.length)try{t._reconnectedCallbacks.forEach(l=>l.apply(t,[t.connection.connectionId]))}catch(l){t._logger.log(c.Error,`An onreconnected callback called with connectionId '${t.connection.connectionId}; threw error '${l}'.`)}return}catch(l){if(t._logger.log(c.Information,`Reconnect attempt failed because of error '${l}'.`),t._connectionState!==_.Reconnecting)return t._logger.log(c.Debug,`Connection moved to the '${t._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(t._connectionState===_.Disconnecting&&t._completeClose());i=l instanceof Error?l:new Error(l.toString()),a=t._getNextRetryDelay(s++,Date.now()-o,i)}}t._logger.log(c.Information,`Reconnect retries have been exhausted after ${Date.now()-o} ms and ${s} failed attempts. Connection disconnecting.`),t._completeClose()})()}_getNextRetryDelay(e,t,o){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:o})}catch(s){return this._logger.log(c.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${s}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(o=>{const s=t[o];try{s(null,e)}catch(i){this._logger.log(c.Error,`Stream 'error' callback called with '${e}' threw error: ${ae(i)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,o,s){if(o)return 0!==s.length?{arguments:t,streamIds:s,target:e,type:p.Invocation}:{arguments:t,target:e,type:p.Invocation};{const i=this._invocationId;return this._invocationId++,0!==s.length?{arguments:t,invocationId:i.toString(),streamIds:s,target:e,type:p.Invocation}:{arguments:t,invocationId:i.toString(),target:e,type:p.Invocation}}}_launchStreams(e,t){if(0!==e.length){t||(t=Promise.resolve());for(const o in e)e[o].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(o)))},error:s=>{let i;i=s instanceof Error?s.message:s&&s.toString?s.toString():"Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(o,i)))},next:s=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(o,s)))}})}}_replaceStreamingParams(e){const t=[],o=[];for(let s=0;s<e.length;s++){const i=e[s];if(this._isObservable(i)){const a=this._invocationId;this._invocationId++,t[a]=i,o.push(a.toString()),e.splice(s,1)}}return[t,o]}_isObservable(e){return e&&e.subscribe&&"function"==typeof e.subscribe}_createStreamInvocation(e,t,o){const s=this._invocationId;return this._invocationId++,0!==o.length?{arguments:t,invocationId:s.toString(),streamIds:o,target:e,type:p.StreamInvocation}:{arguments:t,invocationId:s.toString(),target:e,type:p.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:p.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:p.StreamItem}}_createCompletionMessage(e,t,o){return t?{error:t,invocationId:e,type:p.Completion}:{invocationId:e,result:o,type:p.Completion}}}class bt{constructor(){this.name="json",this.version=1,this.transferFormat=v.Text}parseMessages(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=M.instance);const o=y.parse(e),s=[];for(const i of o){const a=JSON.parse(i);if("number"!=typeof a.type)throw new Error("Invalid payload.");switch(a.type){case p.Invocation:this._isInvocationMessage(a);break;case p.StreamItem:this._isStreamItemMessage(a);break;case p.Completion:this._isCompletionMessage(a);break;case p.Ping:case p.Close:break;default:t.log(c.Information,"Unknown message type '"+a.type+"' ignored.");continue}s.push(a)}return s}writeMessage(e){return y.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(e,t){if("string"!=typeof e||""===e)throw new Error(t)}}const Ct={trace:c.Trace,debug:c.Debug,info:c.Information,information:c.Information,warn:c.Warning,warning:c.Warning,error:c.Error,critical:c.Critical,none:c.None};class vt{configureLogging(e){if(C.isRequired(e,"logging"),void 0!==e.log)this.logger=e;else if("string"==typeof e){const t=function(r){const e=Ct[r.toLowerCase()];if(void 0!==e)return e;throw new Error(`Unknown log level: ${r}`)}(e);this.logger=new H(t)}else this.logger=new H(e);return this}withUrl(e,t){return C.isRequired(e,"url"),C.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?b(b({},this.httpConnectionOptions),t):$(b({},this.httpConnectionOptions),{transport:t}),this}withHubProtocol(e){return C.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return this.reconnectPolicy=e?Array.isArray(e)?new re(e):e:new re,this}build(){const e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new ht(this.url,e);return V.create(t,this.logger||M.instance,this.protocol||new bt,this.reconnectPolicy)}}var yt=g(8260);let xt=(()=>{class r{constructor(t,o){this.testService=t,this.router=o,this.GetAlo=()=>{this.hubConnection.on("alo",s=>{this.result=s,console.log(s)})},this.getConnectionId=()=>{this.hubConnection.invoke("getconnectionid").then(s=>{console.log(s),this.connectionId=s})},this.addSendDataListener=()=>{this.hubConnection.on("sendata",s=>{this.result=s})}}start(){this.thenable=this.hubConnection.start(),this.thenable.then(()=>console.log("Connection started!")).catch(t=>console.log("Error while establishing connection :("))}startConect(){this.hubConnection=(new vt).withUrl(yt.N.API_ENDPOINT+"/signalr").build(),this.start()}GetOneQuestionUserTestClient(t,o){this.hubConnection.invoke("getOneQuestionUserTestServer",t,o).catch(s=>console.error(s)).then(s=>{console.log(s)})}TimeRun(t,o){this.thenable.then(()=>{this.hubConnection.invoke("presstime",t).catch(s=>console.log(s)),console.log("goi press time"),this.hubConnection.on("dung",()=>{console.log("go"),this.testService.CacularPoint(o).subscribe(s=>{console.log(s)}),this.hubConnection.stop().then(()=>{console.log("disconnected")}),this.router.navigateByUrl(`/test/user-point/${o}`)})})}}return r.\u0275fac=function(t){return new(t||r)(n.LFG(D.q),n.LFG(S.F0))},r.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function St(r,e){if(1&r){const t=n.EpF();n.TgZ(0,"div",4),n.TgZ(1,"label",5),n._uU(2," Nh\u1eadp m\u1eadt kh\u1ea9u ca thi "),n.TgZ(3,"input",6),n.NdJ("ngModelChange",function(s){return n.CHM(t),n.oxw().passWord=s}),n.qZA(),n.TgZ(4,"button",7),n.NdJ("click",function(){return n.CHM(t),n.oxw().CheckPass()}),n._uU(5,"Check"),n.qZA(),n.qZA(),n._UZ(6,"app-notification"),n.qZA()}if(2&r){const t=n.oxw();n.xp6(3),n.Q6J("ngModel",t.passWord)}}function kt(r,e){if(1&r){const t=n.EpF();n.TgZ(0,"div"),n.TgZ(1,"table",8),n.TgZ(2,"thead"),n.TgZ(3,"tr"),n.TgZ(4,"td"),n._uU(5,"Title"),n.qZA(),n.TgZ(6,"td"),n._uU(7,"Student name"),n.qZA(),n.TgZ(8,"td"),n._uU(9,"Create by"),n.qZA(),n.TgZ(10,"td"),n._uU(11,"Start At"),n.qZA(),n.TgZ(12,"td"),n._uU(13,"End At"),n.qZA(),n.TgZ(14,"td"),n._uU(15,"Time"),n.qZA(),n.TgZ(16,"td"),n._uU(17,"Time remain"),n.qZA(),n.TgZ(18,"td"),n._uU(19,"Status"),n.qZA(),n.TgZ(20,"td"),n._uU(21,"Question Count"),n.qZA(),n.qZA(),n.qZA(),n.TgZ(22,"tbody"),n.TgZ(23,"tr"),n.TgZ(24,"td"),n._uU(25),n.qZA(),n.TgZ(26,"td"),n._uU(27),n.qZA(),n.TgZ(28,"td"),n._uU(29),n.qZA(),n.TgZ(30,"td"),n._uU(31),n.qZA(),n.TgZ(32,"td"),n._uU(33),n.qZA(),n.TgZ(34,"td"),n._uU(35),n.qZA(),n.TgZ(36,"td"),n._uU(37),n.qZA(),n.TgZ(38,"td"),n._uU(39),n.qZA(),n.TgZ(40,"td"),n._uU(41),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(42,"button",9),n.NdJ("click",function(){return n.CHM(t),n.oxw().doTest()}),n._uU(43," B\u1eaft \u0111\u1ea7u l\xe0m b\xe0i"),n.qZA(),n.qZA()}if(2&r){const t=n.oxw();n.xp6(25),n.Oqu(t.result.result.data.title),n.xp6(2),n.Oqu(t.result.result.data.studentName),n.xp6(2),n.Oqu(t.result.result.data.createBy),n.xp6(2),n.Oqu(t.result.result.data.startAt),n.xp6(2),n.Oqu(t.result.result.data.endAt),n.xp6(2),n.Oqu(t.result.result.data.time),n.xp6(2),n.Oqu(t.result.result.data.timeRemain),n.xp6(2),n.Oqu(t.result.result.data.status),n.xp6(2),n.Oqu(t.result.result.data.questionCount)}}const Et=[{path:"",children:[{path:"user-test/:id",component:(()=>{class r{constructor(t,o,s,i,a){this.testService=t,this.activeRoute=o,this.router=s,this.signalRService=i,this.notificationService=a,this.urlQuery=new W.e(1,1,"")}ngOnInit(){}CheckPass(){this.activeRoute.params.subscribe(t=>{this.testId=t.id}),this.testService.CheckPass(this.testId,this.passWord).subscribe(t=>{t.message==oe.j.WrongPasss&&this.notificationService.error("Sai m\u1eadt kh\u1ea9u!!"),t.message==oe.j.Success&&this.createTestUser()})}createTestUser(){this.testService.CreateTestUser(this.testId).subscribe(t=>{console.log(t),this.status=t},t=>{console.log(t.error.message)},()=>{this.testService.GetUserTestStatus(this.testId).subscribe(t=>{this.result=t},t=>{console.log(t.error.message)},()=>{console.log(this.result)})})}doTest(){this.signalRService.startConect(),console.log(this.signalRService.hubConnection),this.signalRService.TimeRun(this.result.result.data.time,this.testId),window.open(`/test/do-test/${this.testId}`,"Do test","toolbar=yes,scrollbars=yes,resizable=yes"),this.router.navigateByUrl("/test")}}return r.\u0275fac=function(t){return new(t||r)(n.Y36(D.q),n.Y36(S.gz),n.Y36(S.F0),n.Y36(xt),n.Y36(te.g))},r.\u0275cmp=n.Xpm({type:r,selectors:[["app-user-test"]],decls:6,vars:2,consts:[[2,"width","100%","height","100%"],["style","margin: 0 auto; padding: 60px; font-size: 40px; width: 600px;",4,"ngIf"],[2,"margin","100px auto","font-size","40px"],[4,"ngIf"],[2,"margin","0 auto","padding","60px","font-size","40px","width","600px"],["for",""],["type","text","name","password","placeholder","M\u1eadt kh\u1ea9u",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","btn-primary",2,"padding","5px 8px","font-size","21px",3,"click"],[1,"table-bordered","table-hover",2,"font-weight","700"],["type","button",1,"btn","btn-primary",2,"margin-left","8px",3,"click"]],template:function(t,o){1&t&&(n._UZ(0,"app-header-v2"),n.TgZ(1,"div",0),n.YNc(2,St,7,1,"div",1),n.TgZ(3,"body",2),n.YNc(4,kt,44,9,"div",3),n.qZA(),n.qZA(),n._UZ(5,"app-footer")),2&t&&(n.xp6(2),n.Q6J("ngIf",null==o.result),n.xp6(2),n.Q6J("ngIf",null!=o.result))},directives:[j.V,P.O5,L.c,R.Fj,R.JJ,R.On,ne.c],styles:["table[_ngcontent-%COMP%]{font-weight:700;text-align:center;margin:auto}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{margin-top:10px;width:100%;padding:10px 0}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid black;text-align:center;margin-left:auto;margin-right:auto;padding:5px 25px;font-size:17px}a[_ngcontent-%COMP%]{font-style:revert;margin:8px -10px 11px -15px;padding:2px 19px;font-size:20px}"]}),r})(),canActivate:[N.a]},{path:"do-test/:testId",component:qe,canActivate:[N.a]},{path:"user-point/:testId",component:je,canActivate:[N.a]},{path:"",component:We,canActivate:[N.a]}]},{path:"",redirectTo:"test",pathMatch:"full"}];let Pt=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=n.oAB({type:r}),r.\u0275inj=n.cJS({imports:[[S.Bz.forChild(Et)],S.Bz]}),r})(),At=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=n.oAB({type:r}),r.\u0275inj=n.cJS({imports:[[_e.m,Pt,P.ez,R.u5]]}),r})()}}]);